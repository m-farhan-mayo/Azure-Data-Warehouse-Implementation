{
	"name": "Dimension Tables",
	"properties": {
		"content": {
			"query": "SELECT * FROM silver.silverTable\n\n------------------------\n------DIMCUSTOMERS------\n------------------------\n\nIF NOT EXISTS (  SELECT *  FROM sys.tables t JOIN sys.schemas s ON t.schema_id = s.schema_id\n                    WHERE t.name = 'DimCustomers' AND s.name = 'gold')\n    CREATE EXTERNAL TABLE gold.DimCustomers\n    WITH\n    (\n        LOCATION = 'DimCustomers',\n        DATA_SOURCE = gold_source,\n        FILE_FORMAT = parquet_format\n    )\n    AS\n    SELECT *,ROW_NUMBER() OVER (ORDER BY T.CustomerID) as DimCust\n    FROM\n    (\n        SELECT\n        DISTINCT\n        CustomerID,\n        CustomerName,\n        CustomerEmail,\n        Domain\n    FROM\n        silver.silverTable\n        ) T\n------------------------\n------DIMPRODUCTS------\n------------------------\nIF NOT EXISTS (  SELECT *  FROM sys.tables t JOIN sys.schemas s ON t.schema_id = s.schema_id\n                    WHERE t.name = 'DimProducts' AND s.name = 'gold')\n    CREATE EXTERNAL TABLE gold.DimProducts\n    WITH\n    (\n        LOCATION = 'DimProducts',\n        DATA_SOURCE = gold_source,\n        FILE_FORMAT = parquet_format\n    )\n    AS\n    SELECT * , ROW_NUMBER() OVER (ORDER BY T.ProductID) as DimProd\n    FROM\n    (\n    SELECT\n        DISTINCT\n        ProductID,\n        ProductName,\n        ProductCategory\n    FROM\n        silver.silverTable\n    )T\n------------------------\n------DimRegion------\n------------------------\n\nIF NOT EXISTS (  SELECT *  FROM sys.tables t JOIN sys.schemas s ON t.schema_id = s.schema_id\n                    WHERE t.name = 'DimRegion' AND s.name = 'gold')\n    CREATE EXTERNAL TABLE gold.DimRegion\n    WITH\n    (\n        LOCATION = 'DimRegion',\n        DATA_SOURCE = gold_source,\n        FILE_FORMAT = parquet_format\n    )\n    AS\n    SELECT * , ROW_NUMBER() OVER (ORDER BY T.RegionID) as DimGeog\n    FROM\n    (\n    SELECT\n        DISTINCT\n        RegionID,\n        RegionName,\n        Country\n    FROM\n        silver.silverTable\n    ) T\n\n------------------------\n------DimOrders------\n------------------------\n\nIF NOT EXISTS (  SELECT *  FROM sys.tables t JOIN sys.schemas s ON t.schema_id = s.schema_id\n                    WHERE t.name = 'DimOrders' AND s.name = 'gold')\n    CREATE EXTERNAL TABLE gold.DimOrders\n    WITH\n    (\n        LOCATION = 'DimOrders',\n        DATA_SOURCE = gold_source,\n        FILE_FORMAT = parquet_format\n    )\n    AS\n    SELECT *,  ROW_NUMBER() OVER (ORDER BY T.OrderID) as DimOrders\n    FROM\n    (\n    SELECT\n        DISTINCT\n        OrderID,\n        OrderDate,\n        CustomerID,\n        CustomerName,\n        CustomerEmail,\n        Domain,\n        ProductID,\n        ProductName,\n        ProductCategory,\n        RegionID,\n        RegionName,\n        Country\n    FROM\n        silver.silverTable\n    ) T\n\nSELECT * FROM gold.DimCustomers;\nSELECT * FROM gold.DimOrders;\nSELECT * FROM gold.DimProducts;\nSELECT * FROM gold.DimRegion;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SalesDWH",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}